#cloud-config

# Create cloud-user with proper password authentication
users:
  - name: cloud-user
    gecos: Cloud User
    sudo: ALL=(ALL) NOPASSWD:ALL
    groups: users,wheel
    shell: /bin/bash
    lock_passwd: false
    # Password: packer123 (will be replaced with SHA-512 hash by GitHub Actions)
    passwd: "PLACEHOLDER_PASSWORD_HASH"

ssh_pwauth: true
disable_root: false

# Ensure SSH service is enabled and started
bootcmd:
  - systemctl enable sshd
  - systemctl start sshd

# Set timezone
timezone: UTC

# Configure package updates
package_update: false
package_upgrade: false

# Ensure cloud-init completes quickly
cloud_final_modules:
  - scripts-user
  - ssh-authkey-fingerprints
  - keys-to-console
  - phone-home
  - final-message
  - power-state-change
